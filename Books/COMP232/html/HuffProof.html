
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>9.20. Proof of Optimality for Huffman Coding &mdash; COMP232: Data Structures and Algorithms</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/normalize.css" type="text/css" />
    <link rel="stylesheet" href="../../../JSAV/css/JSAV.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaMOD-min.css" type="text/css" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaStyle-min.css" type="text/css" />
    
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.4.1',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      "HTML-CSS": {
        scale: "80"
      }
    });
  </script>
    <link rel="index" title="COMP232: Data Structures and Algorithms" href="index.html" />
    <link rel="next" title="21. Binary Tree Chapter Summary" href="BinaryChapSumm.html" />
    <link rel="prev" title="19. Trees versus Tries" href="TreeTrie.html" />

  </head>

  <body>


      <div class="header">
        
  
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../JSAV/lib/jquery.transit.js"></script>
    <script type="text/javascript" src="../../../JSAV/lib/raphael.js"></script>
    <script type="text/javascript" src="../../../JSAV/build/JSAV-min.js"></script>
    <script type="text/javascript" src="_static/config.js"></script>
    <script type="text/javascript" src="../../../lib/odsaUtils-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaMOD-min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
    <script type="text/javascript" src="../../../lib/dataStructures.js"></script>
    <script type="text/javascript" src="../../../lib/conceptMap.js"></script>

        
<a id="username-link" style="float:right;color:red;margin:10px 20px auto; display: none" class="username-link" href="Gradebook.html"></a>
<a id="login-link" style="float:right;color:red;margin:10px 20px auto" class="login-link" href="#"><Macro 'login'></a>
<div id="login-box" class="login-popup">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <label class="username">
        <span>Username</span>
        <input id="username" value="" type="text" autocomplete="on" placeholder="Username" tabindex="1">
      </label>
      <label class="password">
        <span>Password</span>
        <input id="password" value="" type="password" placeholder="Password" tabindex="2">
        <span><a id="forgot" href="#">Forgot your password?</a></span>
      </label>

      <p>
        <input type="submit" id="login-submit-button" value="Sign in" tabindex="3" />
      </p>
      <p>
        <input type="button" id="register-button" value="Register" tabindex="4" />
      </p>
    </fieldset>
  </form>
</div>

        
<a id="registration-link" style="float:right;color:red;margin:10px 20px auto" class="registration-link" href="#">Register</a>
<div id="registration-box" class="registration-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <div id="register_error" class="error"></div>
      <label class="username">
        <span>Username:</span>
        <input type="text" id="user" placeholder="Username" />
      </label>

      <label class="password">
        <span>Password</span>
        <input id="pass" type="password" placeholder="Password" />
      </label>

      <label class="password">
        <span>Confirm Password</span>
        <input id="rpass" type="password" placeholder="Confirm Password" />
      </label>

      <label class="email">
        <span>Email:</span>
        <input type="text" id="email" placeholder="Email">
      </label>

      <p>
        <input type="submit" id="register-submit-button" value="Register &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>
<img class="leftlogo" src="_static/OpenDSALogoT64.png" alt="Logo"/><div class="title-wrapper">
          <div class="title-inbetween" style="display: table-cell; vertical-align: middle;">
            <div class="title-content">
              <h1 class="heading" ><a href="index.html">
                <span>COMP232: Data Structures and Algorithms</span></a></h1>
              <h2 class="heading" ><span>Chapter 9 Binary Trees</span></h2>
            </div>
          </div>
        </div>
      </div>
      <div class="topnav">
        <p>
            <a style="float:left;color:blue;" href="../source/HuffProof.rst"
              target="_blank" rel="nofollow">Show Source | </a>&#160;&#160;
            <a class="abt" style="float:left;color:blue;" href="#" rel="nofollow">| About</a>&#160;&#160;

          
        «&#160;&#160;<a id="prevmod" href="TreeTrie.html">9.19. Trees versus Tries</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod" href="BinaryChapSumm.html">9.21. Binary Tree Chapter Summary</a>&#160;&#160;»


        </p>
      </div>
       
      <div class="content">
        
  <script>ODSA.SETTINGS.DISP_MOD_COMP = true;ODSA.SETTINGS.MODULE_NAME = "HuffProof";ODSA.SETTINGS.MODULE_LONG_NAME = "Proof for Huffman Coding";ODSA.SETTINGS.MODULE_CHAPTER = "Binary Trees"; ODSA.SETTINGS.BUILD_DATE = "2017-11-27 23:03:57"; ODSA.SETTINGS.BUILD_CMAP = false;JSAV_OPTIONS['lang']='en';JSAV_EXERCISE_OPTIONS['code']='java_generic';</script><link href="../../../AV/Binary/HuffProofCON.css" rel="stylesheet" type="text/css" />
<div class="section" id="proof-of-optimality-for-huffman-coding">
<h1>9.20. Proof of Optimality for Huffman Coding<a class="headerlink" href="#proof-of-optimality-for-huffman-coding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>9.20.1. Proof of Optimality for Huffman Coding<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Huffman tree building is an example of a
<a class="reference internal" href="Glossary.html#term-greedy-algorithm"><em class="xref std std-term ODSAterm">greedy algorithm</em></a>.
At each step, the algorithm makes a &quot;greedy&quot; decision to merge
the two subtrees with least weight.
This makes the algorithm simple, but does it give the desired result?
This section concludes with a proof that the Huffman tree
indeed gives the most efficient arrangement for the set of letters.
The proof requires the following lemma.</p>
<p><strong>Lemma:</strong>
For any Huffman tree built by function <code class="docutils literal"><span class="pre">buildHuff</span></code> containing at
least two letters, the two letters with least frequency are stored
in sibling nodes whose depth is at least as deep as any other leaf
nodes in the tree.</p>
<p><strong>Proof:</strong>
Call the two letters with least frequency <span class="math">\(l_1\)</span>
and <span class="math">\(l_2\)</span>.
They must be siblings because <code class="docutils literal"><span class="pre">buildHuff</span></code>
selects them in the first step of the construction process.
Assume that <span class="math">\(l_1\)</span> and <span class="math">\(l_2\)</span> are
not the deepest nodes in the tree.
In this case, the Huffman tree must either look as shown in
Figure <a href="HuffProof.html#hproof">9.20.1</a>, or effectively symmetrical to
this.
For this situation to occur, the parent of <span class="math">\(l_1\)</span>
and <span class="math">\(l_2\)</span>,
labeled <span class="math">\(V\)</span>, must have greater weight than the node
labeled <span class="math">\(X\)</span>.
Otherwise, function <code class="docutils literal"><span class="pre">buildHuff</span></code> would have selected node
<span class="math">\(V\)</span> in place of node <span class="math">\(X\)</span> as the child of node
<span class="math">\(U\)</span>.
However, this is impossible because <span class="math">\(l_1\)</span> and
<span class="math">\(l_2\)</span> are the letters with least frequency.</p>
<div class="divdgm" id="hproof">
<div id="HuffProofCON">
</div>
<p class="caption" style="text-align: center"> Figure 9.20.1: An impossible Huffman tree, showing the situation where the two
nodes with least weight, <span class="math">\(l_1\)</span> and
<span class="math">\(l_2\)</span>, are not the deepest nodes in the tree.
Triangles represent subtrees.</p>
</div>
<p>Here is the proof.</p>
<blockquote>
<div><p><strong>Theorem:</strong>
Function <code class="docutils literal"><span class="pre">buildHuff</span></code> builds the Huffman tree with the minimum
external path weight for the given set of letters.</p>
<p><strong>Proof:</strong>
The proof is by induction on <span class="math">\(n\)</span>, the number of letters.</p>
<ul class="simple">
<li><strong>Base Case:</strong> For <span class="math">\(n = 2\)</span>, the Huffman tree must have the
minimum external path weight because there are only two possible
trees, each with identical weighted path lengths for the two
leaves.</li>
<li><strong>Induction Hypothesis:</strong> Assume that any tree created by
<code class="docutils literal"><span class="pre">buildHuff</span></code> that contains <span class="math">\(n-1\)</span> leaves has minimum
external path length.</li>
<li><strong>Induction Step:</strong> Given a Huffman tree <span class="math">\(\mathbf{T}\)</span>
built by <code class="docutils literal"><span class="pre">buildHuff</span></code> with <span class="math">\(n\)</span> leaves,
<span class="math">\(n \geq 2\)</span>, suppose that
<span class="math">\(w_1 \leq w_2 \leq ... \leq w_n\)</span> where
<span class="math">\(w_1\)</span> to <span class="math">\(w_n\)</span> are the weights of the letters.
Call <span class="math">\(V\)</span> the parent of the letters with frequencies
<span class="math">\(w_1\)</span> and <span class="math">\(w_2\)</span>.
From the lemma, we know that the leaf nodes containing the
letters with frequencies <span class="math">\(w_1\)</span> and <span class="math">\(w_2\)</span> are as
deep as any nodes in <span class="math">\(\mathbf{T}\)</span>.
If any other leaf nodes in the tree were deeper, we could reduce
their weighted path length by swapping them with <span class="math">\(w_1\)</span> or
<span class="math">\(w_2\)</span>.
But the lemma tells us that no such deeper nodes exist.
Call <span class="math">\(\mathbf{T}'\)</span> the Huffman tree that is
identical to <span class="math">\(\mathbf{T}\)</span> except that node <span class="math">\(V\)</span> is
replaced with a leaf node <span class="math">\(V'\)</span> whose weight is
<span class="math">\(w_1 + w_2\)</span>.
By the induction hypothesis, <span class="math">\(\mathbf{T}'\)</span> has minimum
external path length.
Returning the children to <span class="math">\(V'\)</span> restores tree
<span class="math">\(\mathbf{T}\)</span>, which must also have minimum external path
length.</li>
</ul>
<p>Thus by mathematical induction, function <code class="docutils literal"><span class="pre">buildHuff</span></code> creates
the Huffman tree with minimum external path length.</p>
</div></blockquote>
<script type="text/javascript" src="../../../AV/Binary/HuffProofCON.js"></script>
</div>
</div>


      </div>
      <div class="bottomnav">
      <p><span class="email_div" style="display:inline;"><a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a><a style="float:left;color:blue;" rel="nofollow" href="../../../lib/Privacy.html" target="_blank">| Privacy |</a> <a style="float:left;color:blue;" rel="nofollow" href="../../../lib/license.html" target="_blank">| License</a></span>&#160;&#160;
      
        «&#160;&#160;<a id="prevmod1" href="TreeTrie.html">9.19. Trees versus Tries</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod1" href="BinaryChapSumm.html">9.21. Binary Tree Chapter Summary</a>&#160;&#160;»

</p>
      </div>
      <img style="float:right;" src="_static/nsf1.gif" height="62" width="62" alt="nsf"/>


    <div class="footer">
      <p>
        <span class="email_div" style="display:inline;">
          <a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a>
          <a id="bugreport-link" style="float:left;color:blue;" class="bugreport-link" href="#">| Report a bug</a>
        </span>
      </p>
        &copy; Copyright 2016 by OpenDSA Project Contributors and distributed under an MIT license.
      Last updated on Nov 27, 2017.
      Created using <a target="_blank" href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.
    </div>
    
<div id="bugreport-box" class="bugreport-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="report" action="https://#">
    <fieldset class="textbox">
      <div id="bug_error" class="error"></div>
      <label>
        <span>Summary*:</span>
        <input type="text" id="b_title" placeholder="Summary" />
      </label>

      <label class="os">
        <span>Operating system*:</span>
        <select id="b_os">
          <option value="windows">Windows</option>
          <option value="macos">Mac OS</option>
          <option value="linux">Linux</option>
          <option value="ios">iOS</option>
          <option value="android">Android</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="browser">
        <span>Browser*:</span>
        <select id="b_browser">
          <option value="chrome">Chrome</option>
          <option value="safari">Safari</option>
          <option value="internetexplorer">Internet Explorer</option>
          <option value="opera">Opera</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="description">
        <span>Description*:</span><br>
        <textarea id="b_description" rows="5" cols="25" placeholder="***BUG** Please enter: (1) a consice description of the problem. (2) steps to reproduce bug. (3) the version of your browser and operating system."></textarea>
      </label>

      <label class="screenshot">
        <span>Attach a screenshot (optional):</span>
        <input type="file" id="b_screenshot" accept="image/*" placeholder="Attach a screenshot (optional)">
      </label>

      <p>
        <input type="submit" id="bug-submit-button" value="Submit &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>

  </body>
</html>