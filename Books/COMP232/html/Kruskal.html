
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>16.7. Kruskal&#39;s Algorithm &mdash; COMP232: Data Structures and Algorithms</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/normalize.css" type="text/css" />
    <link rel="stylesheet" href="../../../JSAV/css/JSAV.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaMOD-min.css" type="text/css" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaStyle-min.css" type="text/css" />
    
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.4.1',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      "HTML-CSS": {
        scale: "80"
      }
    });
  </script>
    <link rel="index" title="COMP232: Data Structures and Algorithms" href="index.html" />
    <link rel="next" title="8. All-Pairs Shortest Paths" href="Floyd.html" />
    <link rel="prev" title="6. Minimal Cost Spanning Trees" href="MCST.html" />

  </head>

  <body>


      <div class="header">
        
  
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../JSAV/lib/jquery.transit.js"></script>
    <script type="text/javascript" src="../../../JSAV/lib/raphael.js"></script>
    <script type="text/javascript" src="../../../JSAV/build/JSAV-min.js"></script>
    <script type="text/javascript" src="_static/config.js"></script>
    <script type="text/javascript" src="../../../lib/odsaUtils-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaMOD-min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
    <script type="text/javascript" src="../../../lib/dataStructures.js"></script>
    <script type="text/javascript" src="../../../lib/conceptMap.js"></script>

        
<a id="username-link" style="float:right;color:red;margin:10px 20px auto; display: none" class="username-link" href="Gradebook.html"></a>
<a id="login-link" style="float:right;color:red;margin:10px 20px auto" class="login-link" href="#"><Macro 'login'></a>
<div id="login-box" class="login-popup">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <label class="username">
        <span>Username</span>
        <input id="username" value="" type="text" autocomplete="on" placeholder="Username" tabindex="1">
      </label>
      <label class="password">
        <span>Password</span>
        <input id="password" value="" type="password" placeholder="Password" tabindex="2">
        <span><a id="forgot" href="#">Forgot your password?</a></span>
      </label>

      <p>
        <input type="submit" id="login-submit-button" value="Sign in" tabindex="3" />
      </p>
      <p>
        <input type="button" id="register-button" value="Register" tabindex="4" />
      </p>
    </fieldset>
  </form>
</div>

        
<a id="registration-link" style="float:right;color:red;margin:10px 20px auto" class="registration-link" href="#">Register</a>
<div id="registration-box" class="registration-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <div id="register_error" class="error"></div>
      <label class="username">
        <span>Username:</span>
        <input type="text" id="user" placeholder="Username" />
      </label>

      <label class="password">
        <span>Password</span>
        <input id="pass" type="password" placeholder="Password" />
      </label>

      <label class="password">
        <span>Confirm Password</span>
        <input id="rpass" type="password" placeholder="Confirm Password" />
      </label>

      <label class="email">
        <span>Email:</span>
        <input type="text" id="email" placeholder="Email">
      </label>

      <p>
        <input type="submit" id="register-submit-button" value="Register &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>
<img class="leftlogo" src="_static/OpenDSALogoT64.png" alt="Logo"/><div class="title-wrapper">
          <div class="title-inbetween" style="display: table-cell; vertical-align: middle;">
            <div class="title-content">
              <h1 class="heading" ><a href="index.html">
                <span>COMP232: Data Structures and Algorithms</span></a></h1>
              <h2 class="heading" ><span>Chapter 16 Graphs</span></h2>
            </div>
          </div>
        </div>
      </div>
      <div class="topnav">
        <p>
            <a style="float:left;color:blue;" href="../source/Kruskal.rst"
              target="_blank" rel="nofollow">Show Source | </a>&#160;&#160;
            <a class="abt" style="float:left;color:blue;" href="#" rel="nofollow">| About</a>&#160;&#160;

          
        «&#160;&#160;<a id="prevmod" href="MCST.html">16.6. Minimal Cost Spanning Trees</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod" href="Floyd.html">16.8. All-Pairs Shortest Paths</a>&#160;&#160;»


        </p>
      </div>
       
      <div class="content">
        
  <script>ODSA.SETTINGS.DISP_MOD_COMP = true;ODSA.SETTINGS.MODULE_NAME = "Kruskal";ODSA.SETTINGS.MODULE_LONG_NAME = "Kruskal's Algorithm";ODSA.SETTINGS.MODULE_CHAPTER = "Graphs"; ODSA.SETTINGS.BUILD_DATE = "2017-11-27 23:03:58"; ODSA.SETTINGS.BUILD_CMAP = false;JSAV_OPTIONS['lang']='en';JSAV_EXERCISE_OPTIONS['code']='java_generic';</script><div class="section" id="kruskal-s-algorithm">
<h1>16.7. Kruskal's Algorithm<a class="headerlink" href="#kruskal-s-algorithm" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>16.7.1. Kruskal's Algorithm<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Our next MCST algorithm is commonly referred to as
<a class="reference internal" href="Glossary.html#term-kruskal-s-algorithm"><em class="xref std std-term ODSAterm">Kruskal's algorithm</em></a>.
Kruskal's algorithm is also a simple, greedy algorithm.
First partition the set of vertices into <span class="math">\(|\mathbf{V}|\)</span>
<a class="reference internal" href="UnionFind.html#unionfind"><em>disjoint sets</em></a>,
each consisting of one vertex.
Then process the edges in order of weight.
An edge is added to the MCST, and two disjoint sets combined,
if the edge connects two vertices in different disjoint sets.
This process is repeated until only one disjoint set remains.</p>
<div
    id="KruskalUFAV"
    class="embedContainer"
    data-exer-name="KruskalUFAV"
    data-long-name="Kruskal's Algorithm Visualization"
    data-frame-src="../../../AV/Development/KruskalUFAV.html?selfLoggingEnabled=false&amp;localMode=true&amp;module=Kruskal&amp;JOP-lang=en&amp;JXOP-code=java_generic"
    data-frame-width="950"
    data-frame-height="650"
    data-external="false"
    data-points="0"
    data-required="False"
    data-showhide="none"
    data-threshold="1.0"
    data-type="ss">
  
  <div class="center">
    <div id="KruskalUFAV_iframe"></div>
  </div>
</div>
<p>The edges can be processed in order of weight by using a
min-heap.
This is generally faster than sorting the edges first, because in
practice we need only visit a small fraction of the edges before
completing the MCST.
This is an example of finding only a
<a class="reference internal" href="Heapsort.html#heapsort"><em>few smallest elements</em></a> in a list.</p>
<p>The only tricky part to this algorithm is determining if two vertices
belong to the same equivalence class.
Fortunately, the ideal algorithm is available for the purpose ---
the <a class="reference internal" href="UnionFind.html#unionfind"><em>UNION/FIND</em></a>.
Here is an implementation for Kruskal's algorithm.
Class <code class="docutils literal"><span class="pre">KruskalElem</span></code> is used to store the edges on the min-heap.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="c1">// Kruskal&#39;s MST algorithm</span>
<span class="kt">void</span> <span class="nf">Kruskal</span><span class="o">(</span><span class="n">Graph</span> <span class="n">G</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">ParPtrTree</span> <span class="n">A</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ParPtrTree</span><span class="o">(</span><span class="n">G</span><span class="o">.</span><span class="na">nodeCount</span><span class="o">());</span> <span class="c1">// Equivalence array</span>
  <span class="n">KVPair</span><span class="o">[]</span> <span class="n">E</span> <span class="o">=</span> <span class="k">new</span> <span class="n">KVPair</span><span class="o">[</span><span class="n">G</span><span class="o">.</span><span class="na">edgeCount</span><span class="o">()];</span>       <span class="c1">// Minheap array</span>
  <span class="kt">int</span> <span class="n">edgecnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="c1">// Count of edges</span>

  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">G</span><span class="o">.</span><span class="na">nodeCount</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>         <span class="c1">// Put edges in the array</span>
    <span class="kt">int</span><span class="o">[]</span> <span class="n">nList</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="na">neighbors</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">w</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">w</span><span class="o">&lt;</span><span class="n">nList</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">w</span><span class="o">++)</span>
      <span class="n">E</span><span class="o">[</span><span class="n">edgecnt</span><span class="o">++]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">KVPair</span><span class="o">(</span><span class="n">G</span><span class="o">.</span><span class="na">weight</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">nList</span><span class="o">[</span><span class="n">w</span><span class="o">]),</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="n">i</span><span class="o">,</span><span class="n">nList</span><span class="o">[</span><span class="n">w</span><span class="o">]});</span>
  <span class="o">}</span>
  <span class="n">MinHeap</span> <span class="n">H</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MinHeap</span><span class="o">(</span><span class="n">E</span><span class="o">,</span> <span class="n">edgecnt</span><span class="o">,</span> <span class="n">edgecnt</span><span class="o">);</span>
  <span class="kt">int</span> <span class="n">numMST</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="na">nodeCount</span><span class="o">();</span>                   <span class="c1">// Initially n disjoint classes</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">numMST</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>        <span class="c1">// Combine equivalence classes</span>
    <span class="n">KVPair</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="na">removemin</span><span class="o">();</span>        <span class="c1">// Next cheapest edge</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">temp</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span><span class="o">;</span>           <span class="c1">// Must have disconnected vertices</span>
    <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="o">((</span><span class="kt">int</span><span class="o">[])</span><span class="n">temp</span><span class="o">.</span><span class="na">value</span><span class="o">())[</span><span class="mi">0</span><span class="o">];</span>
    <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="o">((</span><span class="kt">int</span><span class="o">[])</span><span class="n">temp</span><span class="o">.</span><span class="na">value</span><span class="o">())[</span><span class="mi">1</span><span class="o">];</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">A</span><span class="o">.</span><span class="na">differ</span><span class="o">(</span><span class="n">v</span><span class="o">,</span> <span class="n">u</span><span class="o">))</span> <span class="o">{</span>               <span class="c1">// If in different classes</span>
      <span class="n">A</span><span class="o">.</span><span class="na">UNION</span><span class="o">(</span><span class="n">v</span><span class="o">,</span> <span class="n">u</span><span class="o">);</span>                    <span class="c1">// Combine equiv classes</span>
      <span class="n">AddEdgetoMST</span><span class="o">(</span><span class="n">v</span><span class="o">,</span> <span class="n">u</span><span class="o">);</span>               <span class="c1">// Add this edge to MST</span>
      <span class="n">numMST</span><span class="o">--;</span>                         <span class="c1">// One less MST</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Kruskal's algorithm is dominated by the time required to
process the edges.
The <code class="docutils literal"><span class="pre">differ</span></code> and <code class="docutils literal"><span class="pre">UNION</span></code> functions are nearly
constant in time if path compression and weighted union is used.
Thus, the total cost of the algorithm is
<span class="math">\(\Theta(|\mathbf{E}| \log |\mathbf{E}|)\)</span> in the worst case,
when nearly all edges must be processed before all the edges of the
spanning tree are found and the algorithm can stop.
More often the edges of the spanning tree are the shorter ones,and
only about <span class="math">\(|\mathbf{V}|\)</span> edges must be processed.
If so, the cost is often close to
<span class="math">\(\Theta(|\mathbf{V}| \log |\mathbf{E}|)\)</span> in the average case.</p>
<div
    id="KruskalPE"
    class="embedContainer"
    data-exer-name="KruskalPE"
    data-long-name="Kruskal's Algorithm Proficiency Exercise"
    data-frame-src="../../../AV/Development/KruskalPE.html?selfLoggingEnabled=false&amp;localMode=true&amp;module=Kruskal&amp;JOP-lang=en&amp;JXOP-code=java_generic"
    data-frame-width="950"
    data-frame-height="650"
    data-external="false"
    data-points="2.0"
    data-required="True"
    data-showhide="show"
    data-threshold="0.9"
    data-type="pe">
  
  <div class="center">
    <div id="KruskalPE_iframe"></div>
  </div>
</div>
<script type="text/javascript" src="../../../AV/Graph/MCSTCON.js"></script>
</div>
</div>


      </div>
      <div class="bottomnav">
      <p><span class="email_div" style="display:inline;"><a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a><a style="float:left;color:blue;" rel="nofollow" href="../../../lib/Privacy.html" target="_blank">| Privacy |</a> <a style="float:left;color:blue;" rel="nofollow" href="../../../lib/license.html" target="_blank">| License</a></span>&#160;&#160;
      
        «&#160;&#160;<a id="prevmod1" href="MCST.html">16.6. Minimal Cost Spanning Trees</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod1" href="Floyd.html">16.8. All-Pairs Shortest Paths</a>&#160;&#160;»

</p>
      </div>
      <img style="float:right;" src="_static/nsf1.gif" height="62" width="62" alt="nsf"/>


    <div class="footer">
      <p>
        <span class="email_div" style="display:inline;">
          <a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a>
          <a id="bugreport-link" style="float:left;color:blue;" class="bugreport-link" href="#">| Report a bug</a>
        </span>
      </p>
        &copy; Copyright 2016 by OpenDSA Project Contributors and distributed under an MIT license.
      Last updated on Nov 27, 2017.
      Created using <a target="_blank" href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.
    </div>
    
<div id="bugreport-box" class="bugreport-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="report" action="https://#">
    <fieldset class="textbox">
      <div id="bug_error" class="error"></div>
      <label>
        <span>Summary*:</span>
        <input type="text" id="b_title" placeholder="Summary" />
      </label>

      <label class="os">
        <span>Operating system*:</span>
        <select id="b_os">
          <option value="windows">Windows</option>
          <option value="macos">Mac OS</option>
          <option value="linux">Linux</option>
          <option value="ios">iOS</option>
          <option value="android">Android</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="browser">
        <span>Browser*:</span>
        <select id="b_browser">
          <option value="chrome">Chrome</option>
          <option value="safari">Safari</option>
          <option value="internetexplorer">Internet Explorer</option>
          <option value="opera">Opera</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="description">
        <span>Description*:</span><br>
        <textarea id="b_description" rows="5" cols="25" placeholder="***BUG** Please enter: (1) a consice description of the problem. (2) steps to reproduce bug. (3) the version of your browser and operating system."></textarea>
      </label>

      <label class="screenshot">
        <span>Attach a screenshot (optional):</span>
        <input type="file" id="b_screenshot" accept="image/*" placeholder="Attach a screenshot (optional)">
      </label>

      <p>
        <input type="submit" id="bug-submit-button" value="Submit &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>

  </body>
</html>